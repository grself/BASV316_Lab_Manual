# Dispersion

```{r 030.01, include = FALSE}

# Load some libraries
library(knitr)
library(kableExtra) # For building pretty tables
library(here)

# Set the rproj home directory
here::here()

# Set some knitr options
options(knitr.table.format = "html")
knitr::opts_chunk$set(
  collapse = TRUE,
  strip.white = TRUE,
  comment = "#>",
  out.width = "65%",
  message=FALSE,
  warnings=FALSE
)

# Turn on the DataCamp Light interactive tools
tutorial::go_interactive()

```


## Introduction

One way to describe a vector is to report its dispersion, or spread. For example, if a poll of 100 potential Chevrolet customers were asked which model they preferred, it would make a lot of difference to a local automobile seller if the responses were fairly evenly distributed among Impala, Camaro, Traverse, and Corvette compared to results where customers selected 90% Impala with the rest distributed among the others. How tightly survey results are grouped (or scattered) is called "dispersion" and this lab explores data dispersion and the methods used to calculate that value with _R_.

-----

## Range

The maximum and minimum values are those at the extreme ends of a vector and the range is nothing more than the maximum minus the minimum values. For the 2016 version of the Scholastic Aptitude Test (SAT) the maximum score is 1600 and the minimum score is 400, so the range is 1600 - 400, or 1200. Even though the range is sometimes expressed as a single number, as in the case of the SAT scores, researchers normally want to know the actual endpoints rather than just the spread and those endpoints are what _R_ reports for range.

### Demonstration: Range

To find the range of a vector, use the `range` function as found in the _R_ script below.

* Lines 2-4: These display the ranges for three different variables in the [trees] data frame.
* Lines 7-8: These lines are very similar to Lines 1-4 but use variables in the [rock] data frame.

<span class="grshilite">This demonstration contains five different examples of finding the range.</span>

```{r 030.02}
# Range for trees
range(trees$Girth)
range(trees$Height)
range(trees$Volume)

# Range for rock.
range(rock$area)
range(rock$perm)

```

### Guided Practice: Range

Using the [faithful] data frame, find the range for _eruptions_.

```{r 030.03, ex="sc030.01", type="pre-exercise-code"}

# No pre-exercise code for this exercise

```

```{r 030.04, ex="sc030.01", type="sample-code"}
# Range for eruptions



```

```{r 030.05, ex="sc030.01", type="solution"}

range(faithful$eruptions)

```

```{r 030.06, ex="sc030.01", type="sct"}

ex1neq <- "Check that the range is being generated for faithful$eruptions."

ex() %>%
  check_function("range") %>%
  check_result() %>%
  check_equal(incorrect_msg = ex1neq)

success_msg("Perfect! You can find the range of a vector!")

```

### Deliverable: Range

Using the [cafe] data frame, find the range for _age_. Include that answer in the deliverable document for this lab.

```{r 030.07, ex="act030.01", type="pre-exercise-code"}

cafe <- read.csv('https://labs.basv316.com/cafe.csv')

```

```{r 030.08, ex="act030.01", type="sample-code"}
# Using the cafe data frame, find the range for age.



```

-----

## Quartiles

A measure that is closely related to the [median] is the first and third quartile. The first quartile (Q1) is the score that splits the lowest 25% of the values from the rest and the third quartile (Q3) splits the highest 25% of the values from the rest. The second quartile (Q2) is the same as the median and, normally, the term _median_ is used rather than Q2. For example, consider this vector: 5, 7, 10, 13, 17, 19, 23. The median of this vector is 13 because three values are smaller and three are larger. The first quartile is 7, which is the median for the lower half of the values (not including 13, the median of the entire vector); or the score that splits the lowest 25% from the rest of the data. The third quartile is 19, which is the median for the upper half of the scores; or the score that splits the highest 25% from the rest of the data.

Occasionally, the word _hinges_ appears in statistical literature. The two hinges for a vector are the medians for the lower half and the upper half of the data, but those halves also include the median for the entire vector. For the simple vector above, the lower hinge is the median of 5, 7, 10, and 13, or 8.5. The upper hinge is the median of 13, 17, 19, and 23, or 18. Quartiles and hinges usually have about the same accuracy but quartiles are more commonly used.

### Demonstration: Quartiles

_R_ calculates and prints the quartiles, along with several other descriptive measures, using the `summary()` function. This is a very important function that returns a great deal of useful information and is a staple in a data scientestâ€™s toolbox. To find the quartiles of a vector, use the `summary` function found in the R script below.

* Lines 2-4: Display summary information for three different variables in the [trees] data frame.
* Lines 7-10: Display summary information for four different variables in the [rock] data frame.

<span class="grshilite">This demonstration contains seven different examples of finding quartiles.</span>

```{r 030.09}
# Summary for trees
summary(trees$Girth)
summary(trees$Height)
summary(trees$Volume)

# Summary for rock.
summary(rock$area)
summary(rock$peri)
summary(rock$shape)
summary(rock$perm)

```


### Guided Practice: Quartiles

Using the [USJudgeRatings] data frame, find the summary for _WRIT_.

```{r 030.10, ex="sc030.02", type="pre-exercise-code"}

# No pre-exercise code for this exercise

```

```{r 030.11, ex="sc030.02", type="sample-code"}
# Find the summary for WRIT



```

```{r 030.12, ex="sc030.02", type="solution"}

summary(USJudgeRatings$WRIT)

```

```{r 030.13, ex="sc030.02", type="sct"}

ex2neq <- "Check that the summary is being generated for USJudgeRatings$WRIT."

ex() %>%
  check_function("summary") %>%
  check_result() %>%
  check_equal(incorrect_msg = ex2neq)

success_msg("Good Job! You found a summary with all of those quartiles!")

```

### Deliverable: Quartiles

Using the [cafe] data frame, find the summary for _age_ and record the values for Q1 and Q3 in the deliverable document for this lab.

```{r 030.14, ex="act030.02", type="pre-exercise-code"}

cafe <- read.csv('https://labs.basv316.com/cafe.csv')

```

```{r 030.15, ex="act030.02", type="sample-code"}
# Using the cafe data frame, find the summary for age and record the values for Q1 and Q3.


```

-----

## IQR (Inter-Quartile Range)

Another measure of dispersion that is occasionally used is the Inter-Quartile Range (IQR); that is, the difference between Q1 and Q3. To find the IQR for a vector, use the IQR function: `IQR`. For example, _R_ reports that the difference between Q1 and Q3 for the horsepower vector in the [mtcars] data frame is 83.5. Since the IQR removes outliers it may sometimes provide a better indication of the data dispersion. 

### Demonstration: IQR (Inter-Quartile Range)

To find the inter-quartile range of a vector, use the `IQR` function found in the R script below. _Note: `IQR` is one of the few functions in R that uses upper-case letters._

* Lines 2-4: Display inter-quartile range for three different variables in the [trees] data frame.
* Lines 7-10: Display inter-quartile range for four different variables in the [rock] data frame.

<span class="grshilite">This demonstration contains seven different examples of find the inter-quartile range (IQR).</span>

```{r 030.16}
# IQR for trees
IQR(trees$Girth)
IQR(trees$Height)
IQR(trees$Volume)

# IQR for rock.
IQR(rock$area)
IQR(rock$peri)
IQR(rock$shape)
IQR(rock$perm)

```

### Guided Practice: IQR (Inter-Quartile Range)

Using the [swiss] data frame, find the IQR for _Agriculture_.

```{r 030.17, ex="sc030.03", type="pre-exercise-code"}

# No pre-exercise code for this exercise

```

```{r 030.18, ex="sc030.03", type="sample-code"}
# Find the IQR for Agriculture



```

```{r 030.19, ex="sc030.03", type="solution"}

IQR(swiss$Agriculture)

```

```{r 030.20, ex="sc030.03", type="sct"}

ex3neq <- "Check that the IQR is being generated for swiss$Agriculture."

ex() %>%
  check_function("IQR") %>%
  check_result() %>%
  check_equal(incorrect_msg = ex3neq)

success_msg("Good Job! The Inter-Quartile Range you found is correct!")

```

### Deliverable: Inter-Quartile Range (IQR)

Using the [cafe] data frame, find the inter-quartile-range (IQR) for _age_. Include that answer in the deliverable document for this lab.

```{r 030.21, ex="act30.3", type="pre-exercise-code"}

cafe <- read.csv('https://labs.basv316.com/cafe.csv')

```

```{r 030.22, ex="act30.3", type="sample-code"}
# Using the cafe data frame, find the iner-quartile range (IQR) for age.



```

-----

## Standard Deviation

The standard deviation of a vector is a number that indicates how much variation there are in the data; or how "scattered" the data are from the mean. In general, the larger the standard deviation then the more variation there is in the data. A vector with a small standard deviation would create a sharply peaked normal distribution curve while a large standard deviation would create a flatter curve. 

Once a standard deviation is calculated, then about 68.2% of the samples will lie closer to the mean than that number. To put it another way, one standard deviation explains about 68.2% of the variance from the mean. To show this concept graphically, consider the three following graphs of IQ scores.

```{r 030.23, echo=FALSE, message=FALSE, warnings=FALSE, results='asis', tut=FALSE}
# Display three different plots that illustrate the first three standard deviations on IQ data
par(mfrow=c(2,2))

#############################
# One standard deviation
mn=100; std=15
lb=100-std; ub=100+std

x <- seq(-4,4,length=100)*std + mn
hx <- dnorm(x,mn,std)

plot(x, hx, 
     type="n", 
     xlab="IQ Values", 
     ylab="",
     main="1 St Dev", 
     axes=FALSE)

i <- x >= lb & x <= ub
lines(x, hx)
polygon(c(lb,x[i],ub), c(0,hx[i],0), col="red") 

area <- pnorm(ub, mn, std) - pnorm(lb, mn, std)
#result <- paste("P(",lb,"< IQ <",ub,") =",
#                signif(area, digits=3))
#mtext(result,3)
axis(1, at=seq(40, 170, 40), pos=0)

#############################
# Two standard deviations
mn=100; std=15
lb=100-(std*2); ub=100+(std*2)

x <- seq(-4,4,length=100)*std + mn
hx <- dnorm(x,mn,std)

plot(x, hx, type="n", 
     xlab="IQ Values", 
     ylab="",
     main="2 St Dev", 
     axes=FALSE)

i <- x >= lb & x <= ub
lines(x, hx)
polygon(c(lb,x[i],ub), c(0,hx[i],0), col="blue") 

area <- pnorm(ub, mn, std) - pnorm(lb, mn, std)
# result <- paste("P(",lb,"< IQ <",ub,") =",
#                 signif(area, digits=3))
# mtext(result,3)
axis(1, at=seq(40, 160, 40), pos=0)

#############################
# Three standard deviations
mn=100; std=15
lb=100-(std*3); ub=100+(std*3)

x <- seq(-4,4,length=100)*std + mn
hx <- dnorm(x,mn,std)

plot(x, hx, 
     type="n", 
     xlab="IQ Values", 
     ylab="",
     main="3 St Dev", 
     axes=FALSE)

i <- x >= lb & x <= ub
lines(x, hx)
polygon(c(lb,x[i],ub), c(0,hx[i],0), col="green") 

area <- pnorm(ub, mn, std) - pnorm(lb, mn, std)
# result <- paste("P(",lb,"< IQ <",ub,") =",
#                 signif(area, digits=3))
# mtext(result,3)
axis(1, at=seq(40, 160, 40), pos=0)

```


The mean of an IQ distribution is 100 and one standard deviation is 15. The shaded area under the first curve, in red, includes about 68.2% of all IQ scores. In the same way, two standard deviations from the mean would include about 95.4% of the data points and is illustrated in blue in the second image; and three standard deviations would include more than 99.7% of the data points and is illustrated in green in the third image.

As one last example, imagine several classes with a total of 500 students where the professors administered an examination worth 100 points. If the mean score for that examination was 80 and the standard deviation was 5, then the professors would know that the scores were fairly tightly grouped (341 scores of the 500 (68.2%) were between 75-85, within 5 points of the mean), and this would probably be good news. On the other hand, if the mean score was 60 and the standard deviation was 15, then the scores were "all over the place" (more precisely, 341 scores of the 500 were between 45-75), and that may mean that the professors would have to re-think how the lesson was taught or maybe that the examination itself was flawed.

It is difficult to categorically state whether a specific standard deviation is good or bad; it is simply a measure of how concentrated the data are around the mean. For something like a manufacturing process where the required tolerance for the parts being produced is tight then the standard deviation for the weights of random samples pulled off of the line must be very small; that is, the parts must be as nearly identical as possible. However, in another context, the standard deviation may be quite large. Imagine measuring the time it takes a group of high school students to run 100 yards. Some would be very fast but others would be much slower and the standard deviation for that data would likely be large.

### Demonstration: Standard Deviation

To find the standard deviation of a vector, use the `sd` function as found in the R script below.

* Lines 2-4: Display standard deviation for three different variables in the [trees] data frame.
* Lines 7-10: Display standard deviation for four different variables in the [rock] data frame.

<span class="grshilite">This demonstration contains seven different examples of finding the standard deviation.</span>

```{r 030.24}
# Summary for trees
sd(trees$Girth)
sd(trees$Height)
sd(trees$Volume)

# Summary for rock.
sd(rock$area)
sd(rock$peri)
sd(rock$shape)
sd(rock$perm)

```

In the results, notice that the tree girth has a standard deviation of about 3.14 inches while the range was 8.3-20.6 inches (the range function is found in an activity earlier in this tutorial). While that range is fairly large, the standard deviation indicates that the girths of most of the trees were within about 6 inches of each other, so the trees were all about the same size. This is an example of how the standard deviation can provide information to help interpret the range.

### Guided Practice: Standard Deviation

Using the [stackloss] data frame, find the standard deviation for _Air.Flow_.

```{r 030.25, ex="sc030.04", type="pre-exercise-code"}

# No pre-exercise code for this exercise

```

```{r 030.26, ex="sc030.04", type="sample-code"}
# Find the standard deviation for Air.Flow


```

```{r 030.27, ex="sc030.04", type="solution"}

sd(stackloss$Air.Flow)

```

```{r 030.28, ex="sc030.04", type="sct"}

ex4neq <- "Check that the standard deviation is being generated for stackloss$Air.Flow."

ex() %>%
  check_function("sd") %>%
  check_result() %>%
  check_equal(incorrect_msg = ex4neq)

success_msg("Perfect! You calculated a standard deviation!")

```

### Deliverable: Standard Deviation

Using the [cafe] data frame, find the standard deviation for _age_. Include the answer in the deliverable document for this lab.

```{r 030.29, ex="act030.04", type="pre-exercise-code"}

cafe <- read.csv('https://labs.basv316.com/cafe.csv')

```

```{r 030.30, ex="act030.04", type="sample-code"}
# Using the cafe data frame, find the standard deviation for age.



```

-----

## Submission

Complete the deliverables in this lab and consolidate the responses into a single document. Name the document with your name and "Lab 3," like "George Self Lab 3" and submit that document for grade.
